!function(a,b){b.Player.registerExtension("displays",{ready:function(){var c=this;this.displays=[],this.$container.find(".smile-display").each(function(){var d=a(this).dataObject("smile"),e="Display",f=b.Display;d.track?(d.display&&(e="Display"+b.util.capitalize(d.display)),f=b[e],f?(d.track=c.getTrackById(d.track)||c.getTrackById(d.track,!0),d.container=a(this),d.player=c,c.displays.push(new f(d))):console.warn("Smile display expects valid display type: smile."+e+" not found")):console.warn("Smile display expects track parameter")})}}),b.Display=function(c){if(!c.container)throw new Error("Display needs container");this.$container=a(c.container),this.$container[0].smileDisplay=this,this.player=c.player,this.cues={},this.visibleOnCue=c.visibleOnCue||!1,this.visibleOnCue&&this.$container.hide(),this.onlyShim=c.onlyShim||!1,this.autoLanguage="undefined"==typeof c.autoLanguage?!0:c.autoLanguage,b.util.bindAll(this,["render","onModeChange","onCueChange"]),c.track&&this.setTrack(c.track)},a.extend(b.Display.prototype,EventDispatcher.prototype,{setTrack:function(a){var b=!this.onlyShim||"native"!=this.player.media.pluginType||window.TextTrack.shim;this.track&&this.unhookTrack(),this.cues={},this.track=a,b&&(this.track.ready(this.render),this.hookTrack(),this.onCueChange())},hookTrack:function(){this.track.addEventListener("cuechange",this.onCueChange),this.track.addEventListener("modechange",this.onModeChange)},unhookTrack:function(){this.track.removeEventListener("cuechange",this.onCueChange),this.track.removeEventListener("modechange",this.onModeChange)},render:function(a,b){{var c;this.player.media.currentTime}if("disabled"!=this.track.mode)for(a=a||0;a<(b||this.track.cues.length);a+=1)c=this.track.cues[a],this.cues[c.id]||(this.cues[c.id]=this.renderCue(c))},renderCue:function(b){return{el:a("<div>").addClass("smile-cue").append(b.text.replace("\n","<br/>")).attr("id",this.track.id+"-cue-"+b.id).hide().appendTo(this.$container)}},onModeChange:function(){if("showing"==this.track.mode||"hidden"==this.track.mode?this.$container.show():this.$container.hide(),this.autoLanguage&&"disabled"==this.track.mode){var a=this,b=this.track.id.split("-"),c=b.slice(0,b.length-1).join("-");setTimeout(10,function(){a.setTrack(a.player.getTrackById(c,!0))})}else this.render()},onCueChange:function(){var b=this.track.id,c=a.map(this.track.activeCues||[],function(a){return b+"-cue-"+a.id});this.visibleOnCue&&this.$container[c.length?"show":"hide"](),this.$container.find(".smile-cue").each(function(){a(this).toggle(c.indexOf(a(this).attr("id"))>-1)})}}),b.DisplaySlides=function(a){b.Display.apply(this,[a])},a.extend(b.DisplaySlides.prototype,b.Display.prototype,{renderCue:function(c){var d=JSON.parse(c.text),e=b.Display.prototype.renderCue.apply(this,[c]);return e.el.empty().append(a("<img>").attr({src:d.images[0].src,title:d.title})),e}})}(jQuery,smile);