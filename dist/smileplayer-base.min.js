!function(a){var b=a.EventDispatcher=function(){};b.prototype={constructor:b,apply:function(a){a.addEventListener=b.prototype.addEventListener,a.hasEventListener=b.prototype.hasEventListener,a.removeEventListener=b.prototype.removeEventListener,a.dispatchEvent=b.prototype.dispatchEvent},addEventListener:function(a,b){void 0===this._listeners&&(this._listeners={});var c=this._listeners;void 0===c[a]&&(c[a]=[]),-1===c[a].indexOf(b)&&c[a].push(b)},hasEventListener:function(a,b){if(void 0===this._listeners)return!1;var c=this._listeners;return void 0!==c[a]&&-1!==c[a].indexOf(b)?!0:!1},removeEventListener:function(a,b){if(void 0!==this._listeners){var c=this._listeners,d=c[a];if(void 0!==d){var e=d.indexOf(b);-1!==e&&d.splice(e,1)}}},dispatchEvent:function(a){if(void 0!==this._listeners){var b=this._listeners,c=b[a.type];if(void 0!==c){a.target=this;for(var d=[],e=c.length,f=0;e>f;f++)d[f]=c[f];for(var f=0;e>f;f++)d[f].call(this,a)}}}}}(window),function(a,b){b.TrackFormatParser={webvvt:{pattern_identifier:/^([a-zA-Z]+)?[0-9]+$/,pattern_timecode:/^([0-9]{2}:[0-9]{2}:[0-9]{2}([,.][0-9]{1,3})?) --\> ([0-9]{2}:[0-9]{2}:[0-9]{2}([,.][0-9]{3})?)(.*)$/,parse:function(c){for(var d,e,f,g=0,h=b.TrackFormatParser.split2(c,/\r?\n/),i={text:[],times:[],ids:[]};g<h.length;g++)if(d=this.pattern_identifier.exec(h[g]),e=this.pattern_timecode.exec(h[g]),(d||e)&&(d&&(g++,e=this.pattern_timecode.exec(h[g])),e&&g<h.length)){for(g++,f=h[g],g++;""!==h[g]&&g<h.length;)f=f+"\n"+h[g],g++;f=a.trim(f).replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi,"<a href='$1' target='_blank'>$1</a>"),i.text.push(f),i.ids.push(d?d[0]:""),i.times.push({start:0==b.Utility.convertSMPTEtoSeconds(e[1])?.2:b.Utility.convertSMPTEtoSeconds(e[1]),stop:b.Utility.convertSMPTEtoSeconds(e[3]),settings:e[5]})}return i}},dfxp:{parse:function(c){c=a(c).filter("tt");var d,e,f=0,g=c.children("div").eq(0),h=g.find("p"),i=c.find("#"+g.attr("style")),j={text:[],times:[]};if(i.length){var k=i.removeAttr("id").get(0).attributes;if(k.length)for(d={},f=0;f<k.length;f++)d[k[f].name.split(":")[1]]=k[f].value}for(f=0;f<h.length;f++){var l,m={start:null,stop:null,style:null};if(h.eq(f).attr("begin")&&(m.start=b.Utility.convertSMPTEtoSeconds(h.eq(f).attr("begin"))),!m.start&&h.eq(f-1).attr("end")&&(m.start=b.Utility.convertSMPTEtoSeconds(h.eq(f-1).attr("end"))),h.eq(f).attr("end")&&(m.stop=b.Utility.convertSMPTEtoSeconds(h.eq(f).attr("end"))),!m.stop&&h.eq(f+1).attr("begin")&&(m.stop=b.Utility.convertSMPTEtoSeconds(h.eq(f+1).attr("begin"))),d){l="";for(var n in d)l+=n+":"+d[n]+";"}l&&(m.style=l),0==m.start&&(m.start=.2),j.times.push(m),e=a.trim(h.eq(f).html()).replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi,"<a href='$1' target='_blank'>$1</a>"),j.text.push(e),0==j.times.start&&(j.times.start=2)}return j}},split2:function(a,b){return a.split(b)}},3!="x\n\ny".split(/\n/gi).length&&(b.TrackFormatParser.split2=function(a,b){var c,d=[],e="";for(c=0;c<a.length;c++)e+=a.substring(c,c+1),b.test(e)&&(d.push(e.replace(b,"")),e="");return d.push(e),d})}(jQuery,mejs),function(a,b){function c(a){return new RegExp("Firefox/"+(a||"")).test(navigator.userAgent)}function d(b){console.log("SET TRACK NODE"),a("track").each(function(){!this.track||this.track.node||b&&this.track!==b||(this.track.node=this,b&&(b.node=this))})}a(function(){d()}),b.MediaElementTracksTrait={addTextTrack:function(a,c,d,e){e||(e={}),e.kind=a,e.label=c,e.language=d;var f=new b.TextTrack(e);return this.textTracks.push(f),f},_initTextTracks:function(a,e){var f=this;shimmed="native"!=this.pluginType||window.TextTrack.shim||c(),this.textTracks||(this.textTracks=new b.TextTrackList),this.textTracks.addEventListener("addtrack",function(a){a.track.node||d(a.track),shimmed?("disabled"!=a.track.mode&&a.track._activate(f),a.track.addEventListener("modechange",function(a){"disabled"==a.track.mode?a.track._deactivate(f):a.track._activate(f)}),a.track._initTextTrack()):a.track._initTextTrack()}),e&&this._parseTextTracks(a)},_parseTextTracks:function(b){var c,d=this;a(b).find("track").each(function(){var b=a(this)[0];c=d.addTextTrack(a(b).attr("kind"),a(b).attr("label"),a(b).attr("srclang"),{id:a(b).attr("id"),node:b,src:a(b).attr("src")})})}},b.TextTrackList=function(){},b.TextTrackList.prototype=new Array,a.extend(b.TextTrackList.prototype,EventDispatcher.prototype,{push:function(c){console.warn("Use addTextTrack on player instead of using textTracks as array"),Array.prototype.push.apply(this,a.makeArray(arguments)),this.dispatchEvent(new b.TrackEvent("addtrack",{track:c})),c.node&&a(c.node).attr("default")&&c.setMode("showing")},getTrackById:function(a){for(var b=0;b<this.length;b+=1)if(this[b].id==a)return this[b]},item:function(a){return this[a]}}),b.TextTrackTrait={_initTextTrack:function(){var a=this,d=this.node;if(this.ready(function(){"disabled"==a.mode&&a.setMode("hidden");for(var b,c=1;b=a.cues.getCueById("");){for(;a.cues.getCueById(c);)c+=1;b.id=c}}),c(31)||c(32))var e=setInterval(function(){var c=d.readyState||d._readyState;window.thaaat=a,c>1&&(2===c&&d.dispatchEvent(new b.TrackEvent("load",{track:a})),clearInterval(e))},1e3);this._bound_update=function(b){a._update(b)}},setMode:function(a){this instanceof b.TextTrack&&this.mode!=a?(this._mode=a,this.dispatchEvent(new b.TrackEvent("modechange",{track:this}))):this instanceof b.TextTrack||this._mode==a||(this.mode=a,this.dispatchEvent(new b.TrackEvent("modechange",{track:this})))},getMode:function(){return this instanceof b.TextTrack?this._mode:this.mode},ready:function(b){var c=this.node||this.id&&a("#"+this.id)[0];if(c)if(console.log("READY","#"+this.id,c.readyState||c._readyState,b),2===(c.readyState||c._readyState)||3===(c.readyState||c._readyState))setTimeout(b,0);else{var d=function(){c.readyState>1&&(c.removeEventListener("load",d),c.removeEventListener("readystatechange",d),setTimeout(b,0))};c.addEventListener("load",d),c.addEventListener("readystatechange",d)}else console.warn("TextTrack id missing! .ready only works with native TextTrack support if <track> node has id attribute set!");return this},_activate:function(a){a.addEventListener("timeupdate",this._bound_update)},_deactivate:function(a){a.removeEventListener("timeupdate",this._bound_update)},_update:function(a){var c=a.target||a.mediaElement,d=this._updateData||{},g=this.cues,h=c.currentTime;if(this.cues.length&&(void 0===d.prevChange||h<d.prevChange||d.nextChange<=h)){var i,j,k,l,m=c.duration,n=0,o=new b.TextTrackCueList,p=!1,q=[],r=[];for(h>=d.nextChange||void 0===d.nextChange?l=void 0!==d.firstActiveIndex?d.firstActiveIndex:0:(p=!0,l=void 0!==d.lastActiveIndex?d.lastActiveIndex:g.length-1);;){if(k=g[l],k.endTime<=h)n=f(n,k.endTime),k.active&&(k.active=!1,r.push(k));else if(h<k.startTime){if(m=e(m,k.startTime),k.active&&(k.active=!1,r.push(k)),!p)break}else p?(o.splice(0,0,k),void 0===j&&(j=l),i=l):(o.push(k),void 0===i&&(i=l),j=l),m=e(m,k.endTime),n=f(n,k.startTime),k.active=!0,q.push(k);if(p){if(0===l)break;l--}else{if(l===g.length-1)break;l++}}this.activeCues=o,d.nextChange=m,d.prevChange=n,d.firstActiveIndex=i,d.lastActiveIndex=j,this._updateData=d,this.dispatchEvent(new b.TrackEvent("cuechange",{track:this}))}}},b.TextTrackCueTrait={isActive:function(){return Array.prototype.indexOf.apply(this.track.activeCues,[this])>-1}};var e=function(a,b){var c=Math.min(a,b);return c!=c?a||b:c},f=function(a,b){var c=Math.max(a,b);return c!=c?a||b:c};b.TextTrack=function(a){a||(a={}),this.kind=a.kind||"subtitles",this.label=a.label||"",this.language=a.language||"",this.id=a.id,this.node=a.node,this.node&&(this.node.track=this),this.src=a.src,this.cues=new b.TextTrackCueList,this.activeCues=new b.TextTrackCueList,this._mode=a.mode||"hidden",this.node||console.warn("Use addTextTrack on player instead of instantiating TextTrack manually"),Object.defineProperty&&Object.defineProperty(this,"mode",{set:this.setMode,get:this.getMode}),this._loadCues()},a.extend(b.TextTrack.prototype,EventDispatcher.prototype,b.TextTrackTrait,{addCue:function(a){this.cues.push(a)},removeCue:function(a){var b=this.cues.indexOf(a);if(-1===b)throw new Error("Failed to execute 'removeCue' on 'TextTrack': The specified cue is not listed in the TextTrack's list of cues.");this.cues.splice(b,1)},_loadCues:function(){if(this.node&&!this.node._readyState){var c=this.node,d=this;return c._readyState=1,a.ajax({url:this.src,dataType:"text",success:function(a){var e;e="string"==typeof a&&/<tt\s+xml/gi.exec(a)?b.TrackFormatParser.dfxp.parse(a):b.TrackFormatParser.webvvt.parse(a);for(var f,g=0;g<e.text.length;g+=1)f=new(window.VTTCue||window.TextTrackCue)(e.times[g].start,e.times[g].stop,e.text[g],{track:d,id:e.ids[g]}),d.addCue(f);c._readyState=2,d.node.dispatchEvent(new b.TrackEvent("load",{track:d}))},error:function(){c._readyState=3,d.node.dispatchEvent(new b.TrackEvent("error",{track:d}))}})}}}),b.TextTrack.shim=!0,b.TextTrackCueList=function(){},b.TextTrackCueList.prototype=new Array,a.extend(b.TextTrackCueList.prototype,EventDispatcher.prototype,{getCueById:function(a){for(var b=0;b<this.length;b+=1)if(this[b].id==a)return this[b]}}),b.TextTrackCue=function(a,b,c,d){if("undefined"==typeof a||"undefined"==typeof b||"undefined"==typeof c)throw new Error("Failed to construct 'TextTrackCue': 3 arguments required.");d||(d={}),this.startTime=parseFloat(a),this.endTime=parseFloat(b),this.text=""+c,this.id=d.id,this.track=d.track},a.extend(b.TextTrackCue.prototype,b.TextTrackCueTrait,EventDispatcher.prototype,{}),b.TrackEvent=function(a,c){c=c||{bubbles:!1,cancelable:!1,track:void 0};var d=document.createEvent("CustomEvent");if(d.initEvent(a,c.bubbles,c.cancelable),c.track&&!b.TextTrack.prototype.isPrototypeOf(c.track)&&!window.TextTrack.prototype.isPrototypeOf(c.track))throw new Error("Failed to construct 'TrackEvent': 'track' property does not look like a TextTrack");return d.track=c.track,d.cue=c.cue,d.target=d.cue||d.track,d.currentTarget=d.target,d.srcElement=d.target,d},b.TrackEvent.prototype=window.Event,a.extend(b.PluginMediaElement.prototype,b.MediaElementTracksTrait);var g=b.HtmlMediaElementShim.create,h=b.HtmlMediaElementShim.createPlugin;b.HtmlMediaElementShim.createPlugin=function(a,b,c,d,e,f){var g=h.call(this,a,b,c,d,e,f);return g._initTextTracks(a.htmlMediaElement,!0),console.info("Initializing mediaelement shim"),g},b.HtmlMediaElementShim.create=function(c,d){var e=g.call(this,c,d);return"native"!=e.pluginType||(window.TextTrack.shim?(console.info("Initializing textrack shim"),a.extend(e,b.MediaElementTracksTrait),e._initTextTracks(e,!0)):(e._initTextTracks=b.MediaElementTracksTrait._initTextTracks,e._initTextTracks(e))),e},window.HTMLVideoElement&&!window.HTMLVideoElement.prototype.addTextTrack&&a.extend(window.HTMLVideoElement.prototype,b.MediaElementTracksTrait),window.TextTrack?(console.info("Polyfilling TextTrack.setMode, .getMode and .ready"),a.extend(window.TextTrack.prototype,b.TextTrackTrait)):window.TextTrack=b.TextTrack,window.TextTrackList||(window.TextTrackList=b.TextTrackList,window.TextTrackList.shim=!0),window.TextTrackCueList||(window.TextTrackCueList=b.TextTrackCueList,window.TextTrackCueList.shim=!0),window.TextTrackCue?(console.info("Polyfilling TextTrackCue.isActive"),a.extend(window.TextTrackCue.prototype,b.TextTrackCueTrait)):(window.TextTrackCue=b.TextTrackCue,window.TextTrackCue.shim=!0),window.TrackEvent||(window.TrackEvent=b.TrackEvent,window.TrackEvent.shim=!0)}(jQuery,mejs);var smile={};!function(a,b){function c(a){var c=b.util.stringTrim(a);123===c.charCodeAt(0)&&(c=c.slice(1,-1));var d,e,f=[],g=c.match(j),h=0;if(g){g.push(",");for(var i,m=0;i=g[m];++m){var n=i.charCodeAt(0);if(44===n){if(0>=h){d&&f.push(e?{key:d,value:e.join("")}:{unknown:d}),d=e=h=0;continue}}else if(58===n){if(!e)continue}else if(47===n&&m&&i.length>1){var o=g[m-1].match(k);o&&!l[o[0]]&&(c=c.substr(c.indexOf(i)+1),g=c.match(j),g.push(","),m=-1,i="/")}else if(40===n||123===n||91===n)++h;else if(41===n||125===n||93===n)--h;else if(!d&&!e){d=34===n||39===n?i.slice(1,-1):i;continue}e?e.push(i):e=[i]}}return f}var d='"(?:[^"\\\\]|\\\\.)*"',e="'(?:[^'\\\\]|\\\\.)*'",f="/(?:[^/\\\\]|\\\\.)*/w*",g=",\"'{}()/:[\\]",h="[^\\s:,/][^"+g+"]*[^\\s"+g+"]",i="[^\\s]",j=RegExp(d+"|"+e+"|"+f+"|"+h+"|"+i,"g"),k=/[\])"'A-Za-z0-9_$]+$/,l={"in":1,"return":1,"typeof":1};b.util={stringTrim:function(a){return null===a||void 0===a?"":a.trim?a.trim():a.toString().replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},parseObjectLiteral:function(b){var d={};return a.each(c(b),function(a,b){b.unknown?d[b.unknown]=!0:d[b.key]=b.value}),d},capitalize:function(a){return a.substr(0,1).toUpperCase()+a.substr(1)},bindAll:function(b,c){for(var d=0;d<c.length;d+=1)b[c[d]]=a.proxy(b[c[d]],b);return b},horizontalAreas:function(a,b){a.ratio=a.width/a.height,b.ratio=b.width/b.height;var c={ratio:a.ratio+b.ratio,area1:a,area2:b};return a.widthPercentage=a.ratio/c.ratio,b.widthPercentage=b.ratio/c.ratio,c},formatTime:function(a,c,d){for(var e="",f=c?Math.floor(a/1e3):Math.round(a/1e3),g=0;2>g;g+=1)e.length>0&&(e=":"+e),e=b.util.pad(f%60,2)+e,f=Math.floor(f/60);if((f>0||d)&&(e=b.util.pad(f,2)+":"+e),c){var h=""+a;e=e+"."+h.substr(h.length-3)}return e},parseTime:function(a){for(var b=a.split(":"),c=0,d=b.length-1;d>=0;d-=1)c+=d===b.length-1?parseFloat(b[d],10):Math.pow(60,b.length-1-d)*parseInt(b[d],10);return c!==c?0:~~(1e3*c)},pad:function(a,b,c,d){void 0===c&&(c="0");for(var e=""+a,f=(""+a).length;b>f;f+=1)d?e+=c:e=c+e;return e},parseRatio:function(a){var b=null;return a||(a=""),a.search("/")>-1?(a=a.split("/"),b=parseFloat(a[0])/parseFloat(a[1])):a.search("%")>-1?b=parseFloat(a)/100:a&&(b=parseFloat(a)),b},addCssRule:function(a,b){document.styleSheets[0].addRule?document.styleSheets[0].addRule(a,b):document.styleSheets[0].insertRule&&document.styleSheets[0].insertRule(a+"{"+b+"}",0)},stringToDoc:function(a){var b,c;return window.ActiveXObject?(b=new ActiveXObject("Microsoft.XMLDOM"),b.async="false",b.loadXML(a)):(c=new DOMParser,b=c.parseFromString(a,"text/xml")),b}},a.fn.dataObject=function(c){return b.util.parseObjectLiteral(a(this).data(c))},a.throttle=jq_throttle=function(b,c,d,e){function f(){function a(){h=+new Date,d.apply(i,k)}function f(){g=void 0}var i=this,j=+new Date-h,k=arguments;e&&!g&&a(),g&&clearTimeout(g),void 0===e&&j>b?a():c!==!0&&(g=setTimeout(e?f:a,void 0===e?b-j:b))}var g,h=0;return"boolean"!=typeof c&&(e=d,d=c,c=void 0),a.guid&&(f.guid=d.guid=d.guid||a.guid++),f},a.debounce=function(a,b,c){return void 0===c?jq_throttle(a,b,!1):jq_throttle(a,c,b!==!1)},a.delay=function(a,b){return function(){setTimeout(b,a)}}}(jQuery,smile),function(a,b,c){c.Player=function(d,e){if(!(this instanceof c.Player))return new c.Player(d,e);c.util.bindAll(this,["initializeDisplays","onMediaReady","onHandleError","resize"]),e||(e={}),this.smileReadyState=1;var f=a(d),g=f[0].tagName.toLowerCase(),h=this;if("video"==g||"audio"==g?this.$media=f:(f=a(f.find("video,audio")[0]),f.length&&["video","audio"].indexOf(f[0].tagName.toLowerCase())>-1&&(this.$media=f,e.container=a(d))),!this.$media)throw new Error("Needs <video> or <audio> or an element containing one of those");if(this.media=this.$media[0],"undefined"!=typeof this.media.smile)return this.media.smile;this.media.smile=this,this.initializeContainer(e.container),this.options=a.extend({},this.constructor.defaults,this.$media.dataObject("smile"),this.$container.dataObject("smile"),e),this.ready(function(){h.media.addEventListener("loadedmetadata",a.proxy(h.updateRatio,h)),h.updateRatio()}),b.MediaElement(this.$media[0],a.extend({},this.options,{success:this.onMediaReady,error:this.onHandleError}));for(var i in this.options)this.options.hasOwnProperty(i)&&c.Player.extensions[i]&&this.enableExtension(i);a(window).resize(a.debounce(500,this.resize))},a.extend(c.Player.prototype,EventDispatcher.prototype,{initializeContainer:function(b){b?this.$container=a(b):(this.$container=this.$media.closest(".smile-player"),this.$container.length||(this.$container=this.$media)),this.container=this.$container[0],this.container.smile=this,this.$container.attr("id",(this.$media.attr("id")||"smile1")+"-container")},enableExtension:function(b){var d=c.Player.extensions[b];a.extend(this,d.methods),d.initialize&&d.initialize.apply(this),d.ready&&this.ready(a.proxy(d.ready,this)),d.tracksReady&&this.tracksReady(a.proxy(d.tracksReady,this))},onMediaReady:function(a){var b=this;this.smileReadyState=2,this.media=a,this.media.smile=this,this.dispatchEvent({type:"load",target:this}),this._loadtracksFired=!1;for(var c=0;c<this.media.textTracks.length;c+=1)this.media.textTracks[c].ready(function(){!b._loadtracksFired&&b.areTracksReady()&&(b._loadtracksFired=!0,b.dispatchEvent({type:"loadtracks",target:b}))})},onHandleError:function(a){this.smileReadyState=3,this.dispatchEvent({type:"error",error:a,target:this})},ready:function(a){var b=this;if(2===this.smileReadyState||3===this.smileReadyState)setTimeout(a,0);else{var c=function(){b.removeEventListener("load",c),setTimeout(a,0)};this.addEventListener("load",c)}return this},areTracksReady:function(){for(var a=this.$media.find("track"),b=0;b<a.length;b+=1)if((a[b].readyState||a[b]._readyState||0)<2)return!1;return!0},resize:function(){return this.dispatchEvent({type:"resize"}),this},tracksReady:function(a){var b=this;if(this.areTracksReady())setTimeout(a,0);else{var c=function(){b.removeEventListener("loadtracks",c),setTimeout(a,0)};this.addEventListener("loadtracks",c)}return this},getVideoRatio:function(){var b,d=this.$media.attr("width"),e=this.$media.attr("height"),f=a.extend({},this.$media.dataObject("smile"),this.$container.dataObject("smile"));return this.media.videoWidth?b=this.media.videoWidth/this.media.videoHeight:this._attrRatio?b=this._attrRatio:d&&e?(b=this._attrRatio=d/e,this.$media.attr({width:"",height:""})):b=f.ratio?c.util.parseRatio(f.ratio):this.$media.width()/this.$media.height(),b||16/9},updateRatio:function(a){"number"==typeof a&&a||(a=this.getVideoRatio()),c.util.addCssRule("#"+this.$container.attr("id")+" .smile-media:after","padding-top: "+100/a+"%;")},getTracksById:function(a){for(var b,c=[],d=0;d<this.media.textTracks.length;d+=1)b=this.media.textTracks[d],b.id==a+"-"+b.language&&c.push(b);return c},getTrackById:function(a,b){var c,d,e=b?this.getTracksById(a):this.media.textTracks;for(d=0;d<e.length;d+=1){if(c=e[d],b&&"disabled"!=c.mode)return c;if(!b&&c.id==a)return c}return b&&e.length?e[0]:null}}),a.extend(c.Player,{defaults:{},extensions:{},registerExtension:function(a,b){this.extensions[a]={initialize:b.initialize,ready:b.ready,tracksReady:b.tracksReady,methods:b},delete b.initialize,delete b.ready,delete b.tracksReady}}),a.fn.smile=function(b){a(this).each(function(){this.smile||(this.smile=new c.Player(a(this),b))})};var d=b.HtmlMediaElementShim.determinePlayback;b.HtmlMediaElementShim.determinePlayback=function(){var a=d.apply(this,arguments);return a}}(jQuery,mejs,smile);